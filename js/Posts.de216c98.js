(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Posts"],{"11e9":function(t,e,o){var r=o("52a7"),n=o("4630"),i=o("6821"),a=o("6a99"),s=o("69a8"),c=o("c69a"),l=Object.getOwnPropertyDescriptor;e.f=o("9e1e")?l:function(t,e){if(t=i(t),e=a(e,!0),c)try{return l(t,e)}catch(o){}if(s(t,e))return n(!r.f.call(t,e),t[e])}},"4af5":function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-layout",[o("v-flex",{attrs:{xs12:"",sm10:"","offset-sm1":""}},[o("v-container",{attrs:{fluid:"","grid-list-xl":""}},[t.infiniteScrollPosts?o("v-layout",{attrs:{row:"",wrap:""}},t._l(t.infiniteScrollPosts.posts,function(e,r){return o("v-flex",{key:e._id,attrs:{xs12:"",sm6:"",md4:""}},[o("v-card",{attrs:{hover:""}},[o("v-img",{attrs:{src:e.image.url,"lazy-src":"https://picsum.photos/10/6?image="+(5*r+10),height:"30vh",lazy:""},nativeOn:{click:function(o){return t.goToPost(e._id)}}}),o("v-card-actions",[o("v-card-title",{staticClass:"py-2",attrs:{primary:""}},[o("div",[o("h2",{staticClass:"font-weight-regular overflow-hidden"},[t._v("\n                    "+t._s(e.author.username)+"\n                  ")]),o("span",{staticClass:"grey--text"},[t._v(t._s(e.likes)+" likes -\n                    "+t._s(e.comments?e.comments.length:0)+"\n                    comments")])])]),o("v-spacer"),o("v-btn",{attrs:{icon:""},on:{click:function(e){t.showPostCreator=!t.showPostCreator}}},[o("v-icon",[t._v(t._s("mdi-chevron-"+(t.showPostCreator?"up":"down")))])],1)],1),o("v-slide-y-transition",[o("v-card-text",{directives:[{name:"show",rawName:"v-show",value:t.showPostCreator,expression:"showPostCreator"}],staticClass:"grey lighten-4"},[o("v-list-tile",{attrs:{avatar:""}},[o("v-list-tile-avatar",[o("img",{attrs:{src:e.author.avatar}})]),o("v-list-tile-content",[o("v-list-tile-title",{staticClass:"text--primary"},[t._v(t._s(e.author.username))]),o("v-list-tile-sub-title",{staticClass:"font-weight-thin"},[t._v("Added\n                      "+t._s(t.formatCreatedDate(e.created)))])],1),o("v-list-tile-action",[o("v-btn",{attrs:{icon:"",ripple:""}},[o("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-information-outline")])],1)],1)],1)],1)],1)],1)],1)}),1):t._e(),o("v-layout",{staticClass:"my-3"},[o("v-container",[o("v-layout",{attrs:{row:"","justify-center":"","align-center":""}},[t.$apollo.loading?o("v-progress-circular",{attrs:{indeterminate:"",size:50,with:10,color:"primary"}}):t._e()],1),t.showMoreEnabled?t._e():o("v-layout",{attrs:{"justify-center":""}},[o("div",[t._v("没有更多了...")])])],1)],1)],1)],1)],1)},n=[],i=o("75fc"),a=(o("c5f6"),o("c1df")),s=o.n(a),c=o("39ff"),l=6,u={name:"Posts",data:function(){return{showPostCreator:!1}},apollo:{infiniteScrollPosts:{query:c["i"],variables:{pageNum:1,pageSize:l}}},computed:{showMoreEnabled:function(){return this.infiniteScrollPosts&&this.infiniteScrollPosts.hasMore}},mounted:function(){window.onscroll=this.waitScrollToBottom},methods:{formatCreatedDate:function(t){return s()(new Date(Number(t))).format("YYYY-MM-DD hh:mm")},goToPost:function(t){this.$router.push("/posts/".concat(t))},showMorePosts:function(){var t=this;console.log("hello........."),this.$apollo.queries.infiniteScrollPosts.fetchMore({variables:{pageNum:this.infiniteScrollPosts.posts.length/l+1,pageSize:l},updateQuery:function(e,o){var r=o.fetchMoreResult;console.log("previous result",e.infiniteScrollPosts.posts),console.log("fetch more result",r.infiniteScrollPosts);var n=r.infiniteScrollPosts.posts,a=r.infiniteScrollPosts.hasMore;return window.onscroll=t.waitScrollToBottom,{infiniteScrollPosts:{__typename:e.infiniteScrollPosts.__typename,posts:[].concat(Object(i["a"])(e.infiniteScrollPosts.posts),Object(i["a"])(n)),hasMore:a}}}})},waitScrollToBottom:function(){var t=document.documentElement.scrollTop+window.innerHeight+.5>=document.documentElement.offsetHeight;t&&(console.log("hi........."),window.onscroll=null,this.showMoreEnabled&&this.showMorePosts())}},beforeRouteLeave:function(t,e,o){window.onscroll=null,o()}},f=u,d=o("2877"),v=o("6544"),p=o.n(v),h=o("8336"),m=o("b0af"),g=o("99d9"),_=o("12b2"),w=o("a523"),b=o("0e8f"),y=o("132d"),P=o("adda"),S=o("a722"),C=o("ba95"),N=o("40fe"),T=o("c954"),V=o("5d23"),x=o("490a"),E=o("0789"),I=o("9910"),O=Object(d["a"])(f,r,n,!1,null,null,null);e["default"]=O.exports;p()(O,{VBtn:h["a"],VCard:m["a"],VCardActions:g["a"],VCardText:g["b"],VCardTitle:_["a"],VContainer:w["a"],VFlex:b["a"],VIcon:y["a"],VImg:P["a"],VLayout:S["a"],VListTile:C["a"],VListTileAction:N["a"],VListTileAvatar:T["a"],VListTileContent:V["a"],VListTileSubTitle:V["b"],VListTileTitle:V["c"],VProgressCircular:x["a"],VSlideYTransition:E["e"],VSpacer:I["a"]})},"5dbc":function(t,e,o){var r=o("d3f4"),n=o("8b97").set;t.exports=function(t,e,o){var i,a=e.constructor;return a!==o&&"function"==typeof a&&(i=a.prototype)!==o.prototype&&r(i)&&n&&n(t,i),t}},"8b97":function(t,e,o){var r=o("d3f4"),n=o("cb7c"),i=function(t,e){if(n(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=o("9b43")(Function.call,o("11e9").f(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(n){e=!0}return function(t,o){return i(t,o),e?t.__proto__=o:r(t,o),t}}({},!1):void 0),check:i}},9093:function(t,e,o){var r=o("ce10"),n=o("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,n)}},"99d9":function(t,e,o){"use strict";var r=o("80d2"),n=o("b0af"),i=o("adda"),a=o("d9bd"),s=i["a"].extend({name:"v-card-media",mounted:function(){Object(a["d"])("v-card-media",this.src?"v-img":"v-responsive",this)}}),c=o("12b2");o.d(e,"a",function(){return l}),o.d(e,"b",function(){return u});var l=Object(r["d"])("v-card__actions"),u=Object(r["d"])("v-card__text");n["a"],c["a"]},aa77:function(t,e,o){var r=o("5ca1"),n=o("be13"),i=o("79e5"),a=o("fdef"),s="["+a+"]",c="​",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),f=function(t,e,o){var n={},s=i(function(){return!!a[t]()||c[t]()!=c}),l=n[t]=s?e(d):a[t];o&&(n[o]=l),r(r.P+r.F*s,"String",n)},d=f.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=f},c5f6:function(t,e,o){"use strict";var r=o("7726"),n=o("69a8"),i=o("2d95"),a=o("5dbc"),s=o("6a99"),c=o("79e5"),l=o("9093").f,u=o("11e9").f,f=o("86cc").f,d=o("aa77").trim,v="Number",p=r[v],h=p,m=p.prototype,g=i(o("2aeb")(m))==v,_="trim"in String.prototype,w=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){e=_?e.trim():d(e,3);var o,r,n,i=e.charCodeAt(0);if(43===i||45===i){if(o=e.charCodeAt(2),88===o||120===o)return NaN}else if(48===i){switch(e.charCodeAt(1)){case 66:case 98:r=2,n=49;break;case 79:case 111:r=8,n=55;break;default:return+e}for(var a,c=e.slice(2),l=0,u=c.length;l<u;l++)if(a=c.charCodeAt(l),a<48||a>n)return NaN;return parseInt(c,r)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,o=this;return o instanceof p&&(g?c(function(){m.valueOf.call(o)}):i(o)!=v)?a(new h(w(e)),o,p):w(e)};for(var b,y=o("9e1e")?l(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),P=0;y.length>P;P++)n(h,b=y[P])&&!n(p,b)&&f(p,b,u(h,b));p.prototype=m,m.constructor=p,o("2aba")(r,v,p)}},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);